(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a7da4f6"],{"30d2":function(e,t,r){"use strict";var n=r("afd7"),i=r.n(n);i.a},"408b":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"userWrap"},[r("el-row",{staticClass:"el-form100 m20",attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-select",{attrs:{placeholder:"请选择商品","value-key":"id",clearable:""},model:{value:e.searchObj.productId,callback:function(t){e.$set(e.searchObj,"productId",t)},expression:"searchObj.productId"}},e._l(e.products,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-col",{attrs:{span:4}},[r("el-select",{attrs:{placeholder:"请选择身份","value-key":"id",clearable:""},model:{value:e.searchObj.identityId,callback:function(t){e.$set(e.searchObj,"identityId",t)},expression:"searchObj.identityId"}},e._l(e.identitys,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-col",{staticClass:"textLeft",attrs:{span:16}},[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"ProductPriceView",expression:"'ProductPriceView'"}],attrs:{type:"primary"},on:{click:e.searchM}},[e._v("查询 ")]),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"ProductPriceCreate",expression:"'ProductPriceCreate'"}],attrs:{type:"success"},on:{click:e.addPrice}},[e._v("添加采购价 ")])],1)],1),r("my-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.data}},[e._l(e.columnslist,(function(e){return r("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label}})})),r("el-table-column",{attrs:{label:"采购价"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("ul",[r("li",[r("span",[e._v("首次经销：")]),r("span",[e._v(e._s(t.row.firstPurchasePrice))])]),r("li",[r("span",{staticClass:"weight"},[e._v("二次裂变：")]),r("span",{staticClass:"weight"},[e._v(e._s(t.row.secondPurchasePrice))])])])]}}])}),r("el-table-column",{attrs:{label:"库存预警数"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("ul",[r("li",[r("span",[e._v("经销库：")]),r("span",[e._v(e._s(t.row.firstWarningAmount))])]),r("li",[r("span",{staticClass:"weight"},[e._v("裂变库：")]),r("span",{staticClass:"weight"},[e._v(e._s(t.row.secondWarningAmount))])])])]}}])}),r("el-table-column",{attrs:{label:"分润"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("ul",[r("li",[r("span",[e._v("首次经销：")]),r("span",[e._v(e._s(t.row.firstProfitPrice))])]),r("li",[r("span",{staticClass:"weight"},[e._v("二次裂变：")]),r("span",{staticClass:"weight"},[e._v(e._s(t.row.secondProfitPrice))])])])]}}])}),r("el-table-column",{attrs:{prop:"timeV",label:"价格有效期"}}),r("el-table-column",{attrs:{label:"操作",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"ProductPriceUpdate",expression:"'ProductPriceUpdate'"}],attrs:{type:"text",size:"small"},on:{click:function(r){return e.edit(t)}}},[e._v(" 编辑 ")]),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"ProductPriceDelete",expression:"'ProductPriceDelete'"}],attrs:{type:"text",size:"small"},on:{click:function(r){return e.del(t)}}},[e._v(" 删除 ")])]}}])})],2),r("el-pagination",{staticClass:"m20",attrs:{background:"",layout:"prev, pager, next,total",total:e.total,"page-size":e.pageSize,"current-page":e.curPage},on:{"current-change":e.currentChange,"update:currentPage":function(t){e.curPage=t},"update:current-page":function(t){e.curPage=t}}}),e.dialogFormVisible?r("el-dialog",{attrs:{title:e.title,visible:e.dialogFormVisible,"close-on-click-modal":e.clickmodal},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"ruleForm",attrs:{model:e.model,"label-width":"150px","label-position":e.labelPosition,rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品：",prop:"productId"}},[r("el-select",{attrs:{placeholder:"请选择商品",disabled:e.disabled},on:{change:e.selectProduction},model:{value:e.model.productId,callback:function(t){e.$set(e.model,"productId",t)},expression:"model.productId"}},e._l(e.products,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"定价："}},[e._v(e._s(e.model.price))])],1)],1),r("el-form-item",{attrs:{label:"身份：",prop:"identityId"}},[r("el-select",{attrs:{placeholder:"请选择身份",disabled:e.disabled},model:{value:e.model.identityId,callback:function(t){e.$set(e.model,"identityId",t)},expression:"model.identityId"}},e._l(e.identitys,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"首次经销采购价：",prop:"firstPurchasePrice"}},[r("el-input-number",{attrs:{precision:2,controls:!1,placeholder:"请输入首次经销"},model:{value:e.model.firstPurchasePrice,callback:function(t){e.$set(e.model,"firstPurchasePrice",t)},expression:"model.firstPurchasePrice"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"经销库存预警数：",prop:"firstPurchasePrice"}},[r("el-input-number",{attrs:{precision:0,controls:!1,placeholder:"请输入首次经销"},model:{value:e.model.firstWarningAmount,callback:function(t){e.$set(e.model,"firstWarningAmount",t)},expression:"model.firstWarningAmount"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"二次裂变采购价：",prop:"secondPurchasePrice"}},[r("el-input-number",{attrs:{precision:2,controls:!1,placeholder:"请输入二次裂变"},model:{value:e.model.secondPurchasePrice,callback:function(t){e.$set(e.model,"secondPurchasePrice",t)},expression:"model.secondPurchasePrice"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"裂变库存预警数：",prop:"secondPurchasePrice"}},[r("el-input-number",{attrs:{precision:0,controls:!1,placeholder:"请输入二次裂变"},model:{value:e.model.secondWarningAmount,callback:function(t){e.$set(e.model,"secondWarningAmount",t)},expression:"model.secondWarningAmount"}})],1)],1)],1),r("el-form-item",{attrs:{label:"首次销售分润：",prop:"firstProfitPrice"}},[r("el-input-number",{attrs:{precision:2,controls:!1,placeholder:"请输入首次销售"},model:{value:e.model.firstProfitPrice,callback:function(t){e.$set(e.model,"firstProfitPrice",t)},expression:"model.firstProfitPrice"}})],1),r("el-form-item",{attrs:{label:"二次裂变分润：",prop:"secondProfitPrice"}},[r("el-input-number",{attrs:{precision:2,controls:!1,placeholder:"请输入二次裂变"},model:{value:e.model.secondProfitPrice,callback:function(t){e.$set(e.model,"secondProfitPrice",t)},expression:"model.secondProfitPrice"}})],1),r("el-form-item",{attrs:{label:"经销扣除库存",prop:"type"}},[r("el-radio-group",{model:{value:e.model.type,callback:function(t){e.$set(e.model,"type",t)},expression:"model.type"}},e._l(e.typeList,(function(t){return r("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.name)+" ")])})),1)],1),r("el-form-item",{attrs:{label:"价格有效期：",prop:"date"}},[r("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.model.date,callback:function(t){e.$set(e.model,"date",t)},expression:"model.date"}})],1),r("el-form-item",{attrs:{label:""}},[r("el-button",{attrs:{type:"success"},on:{click:function(t){return e.save("ruleForm")}}},[e._v("保存")])],1)],1)],1):e._e()],1)},i=[],a=(r("4194"),r("fe59"),r("053b"),r("08ba"),r("0eaa")),c=(r("b449"),r("ae9a")),o=r("bcaf"),s=r("a833"),u={1:"商品售价设置",2:"商品售价编辑"},l={name:"ProductPrice",mixins:[o["a"],s["a"]],data:function(){return{rules:{productId:[{required:!0,message:"请选择商品",trigger:["blur","change"]}],identityId:[{required:!0,message:"请选择身份",trigger:["blur","change"]}],firstPurchasePrice:[{required:!0,message:"请输入首次经销",trigger:["blur","change"]}],secondPurchasePrice:[{required:!0,message:"请输入二次裂变",trigger:["blur","change"]}],warningAmount:[{required:!0,message:"请输入库存预警数",trigger:["blur","change"]}],firstProfitPrice:[{required:!0,message:"请输入首次经销分润",trigger:["blur","change"]}],secondProfitPrice:[{required:!0,message:"请输入首次经销分润",trigger:["blur","change"]}],date:[{required:!0,message:"请输入价格有效期",trigger:["blur","change"]}],type:[{required:!0,message:"请选择扣除库存",trigger:["blur","change"]}]},fixPrice:"",searchObj:{productId:"",identityId:"",production:""},model:{type:"",productId:"",identityId:"",firstPurchasePrice:0,secondPurchasePrice:0,beginDate:"",endDate:"",date:[],price:0,firstProfitPrice:110,secondProfitPrice:1110,warningAmount:0,firstWarningAmount:0,secondWarningAmount:0},data:[],columnslist:[{prop:"productV",label:"商品"},{prop:"identityV",label:"身份"},{prop:"priceV",label:"定价"}],identitys:[],products:[],productsPrice:[],state:1,typeList:[]}},computed:{title:function(){return u[this.state]},disabled:function(){return 2===this.state}},methods:{selectProduction:function(){var e=this,t=this.products.find((function(t){return t.id===e.model.productId}));this.model.price=t.price},resetData:function(){this.model={productId:"",identityId:"",firstPurchasePrice:0,secondPurchasePrice:0,beginDate:"",endDate:"",date:[],price:0,firstProfitPrice:0,secondProfitPrice:0,warningAmount:0,firstWarningAmount:0,secondWarningAmount:0}},edit:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.row,Object.assign(t.model,n),t.selectProduction(),t.model.date=[new Date(t.model.beginDate),new Date(t.model.endDate)],t.state=2,t.open(),r.next=8,t.ApiProduction.getPriceType();case 8:t.typeList=r.sent;case 9:case"end":return r.stop()}}),r)})))()},addPrice:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.resetData(),e.state=1,e.open(),t.next=5,e.ApiProduction.getPriceType();case 5:e.typeList=t.sent;case 6:case"end":return t.stop()}}),t)})))()},del:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=e.row,t.confirmDelMessage("确定要删除该商品定价吗",Object(c["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.ApiProduction.delProductPrice(n.priceId);case 2:if(r=e.sent,r===t.saveSuccess){e.next=5;break}return e.abrupt("return");case 5:case"end":return e.stop()}}),e)}))),Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.searchM();case 1:case"end":return e.stop()}}),e)}))));case 2:case"end":return r.stop()}}),r)})))()},searchM:function(){this.getProductPrice()},resetSearch:function(){this.searchObj.productId="",this.searchObj.identityId="",this.searchM()},handleChange:function(e){console.log(e)},currentChange:function(){this.getProductPrice()},save:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(r){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=21;break}if(t.model.beginDate=t.dayjs(new Date(t.model.date[0])).format("YYYY-MM-DD"),t.model.endDate=t.dayjs(new Date(t.model.date[1])).format("YYYY-MM-DD"),1!=t.state){e.next=11;break}return e.next=6,t.addProductPrice(t.model);case 6:if(n=e.sent,n===t.saveSuccess){e.next=9;break}return e.abrupt("return");case 9:e.next=17;break;case 11:if(2!=t.state){e.next=17;break}return e.next=14,t.putProductPrice(t.model);case 14:if(i=e.sent,i===t.saveSuccess){e.next=17;break}return e.abrupt("return");case 17:t.close(),t.resetSearch(),e.next=23;break;case 21:return console.log("error submit!!"),e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},showDetail:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.row,console.log(r);case 2:case"end":return t.stop()}}),t)})))()},putProductPrice:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiProduction.putProductPrice(e.model);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},getIndetitys:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiUser.getUserIdentitys();case 2:e.identitys=t.sent;case 3:case"end":return t.stop()}}),t)})))()},getProducts:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiProduction.getProduct();case 2:e.products=t.sent;case 3:case"end":return t.stop()}}),t)})))()},getProductPrice:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.openLoading(),t.next=3,e.ApiProduction.productPrice(Object(a["a"])(Object(a["a"])({},e.searchObj),{},{curPage:e.curPage}));case 3:r=t.sent,r.list.forEach((function(t){e.identitys.forEach((function(e){e.id===t.identityId&&(t.identityV=e.name)})),e.products.forEach((function(e){e.id===t.productId&&(t.productV=e.name,t.priceV=e.price)})),t.timeV=t.beginDate+"~"+t.endDate})),e.total=r.rowCount,e.data=r.list,e.closeLoading();case 8:case"end":return t.stop()}}),t)})))()},addProductPrice:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiProduction.postProductPrice(e.model);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getIndetitys();case 2:return t.next=4,e.getProducts();case 4:e.getProductPrice();case 5:case"end":return t.stop()}}),t)})))()}},d=l,p=r("7459"),m=(r("30d2"),r("4023"));function f(e){this["$style"]=p["default"].locals||p["default"]}var h=Object(m["a"])(d,n,i,!1,f,null,null);t["default"]=h.exports},4194:function(e,t,r){"use strict";var n=r("1c8b"),i=r("5dfd").find,a=r("258f"),c=r("ff9c"),o="find",s=!0,u=c(o);o in[]&&Array(1)[o]((function(){s=!1})),n({target:"Array",proto:!0,forced:s||!u},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a(o)},7459:function(e,t,r){"use strict";var n=r("bfa7"),i=r.n(n);t["default"]=i.a},a833:function(e,t,r){"use strict";r("dbb3"),r("4194"),r("fe59"),r("513c"),r("20a5"),r("e35a"),r("5e9f"),r("08ba"),r("b449");var n=r("ae9a"),i=r("0eaa"),a=r("ae8c");t["a"]={inject:["ApiBasic","ApiResource","ApiBase","ApiProduction","ApiOther","ApiUser","ApiReport","cloneDeep","ApiMenu","dayjs","ApiOrder","ApiCourse"],computed:Object(i["a"])({},Object(a["c"])("course",{dictoryObj:"dictoryObj"})),data:function(){return{loading:!0,total:1,uid:"",userList:[],clickmodal:!1}},methods:{filterEnum:function(e,t){return this.dictoryObj[e].find((function(e){return e.key==t})).value},openLoading:function(){this.loading=!0},formatNum:function(e){return e=Number(e),(e.toFixed(2)+"").replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,")},closeLoading:function(){this.loading=!1},confirmDelMessage:function(e,t,r){this.$confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.t0=t,!e.t0){e.next=5;break}return e.next=4,t();case 4:e.t0=e.sent;case 5:n=e.t0,"number"!=typeof n&&r&&r();case 7:case"end":return e.stop()}}),e)}))))},tipMessage:function(e,t){this.$message({showClose:!0,message:e,type:t})},getTreeList:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0;if(Array.isArray(e))return e.forEach((function(a){if(a.parentId===r)return n.push(a),a.children=[],t.getTreeList(e,a[i],a.children,i)})),n},flatten:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.forEach((function(e){e.index=r,n.push(e),e.children&&t.flatten(e.children,r+1,n)})),n},filterAllChild:function(){},remoteMethod:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.ApiUser.getSelectUsers(e);case 2:t.userList=r.sent;case 3:case"end":return r.stop()}}),r)})))()},getTarget:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.filter((function(e){if(e.parentId===t)return e}))}}}},afd7:function(e,t,r){},bfa7:function(e,t,r){e.exports={search:"ProductPrice_search_3DHLM",inputW:"ProductPrice_inputW_1N6NN",static:"ProductPrice_static_3aa0U",searchWrap:"ProductPrice_searchWrap_23Skb",search1:"ProductPrice_search1_1c9Bn",min30:"ProductPrice_min30_1JLe1",m20:"ProductPrice_m20_3OKsB"}}}]);