(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c9df9ede"],{"9e11":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticClass:"section-search",attrs:{size:"small",inline:""}},[a("el-form-item",[a("el-button",{attrs:{type:"success",plain:""},on:{click:function(t){return e.handleDialog("add")}}},[e._v("新增教材模板")])],1)],1),a("my-table",{attrs:{data:e.list}},[a("el-table-column",{attrs:{prop:"id",label:"id"}}),a("el-table-column",{attrs:{prop:"code",label:"编号"}}),a("el-table-column",{attrs:{prop:"title",label:"标题"}}),a("el-table-column",{attrs:{prop:"title",label:"关联环节"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.template_data_details.length?e._l(t.row.template_data_details,(function(t){return a("div",[e._v(" "+e._s(t.title)+" ")])})):[e._v("-")]]}}])}),a("el-table-column",{attrs:{prop:"status_text",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cc-cell-switch",{attrs:{value:t.row.status},on:{click:function(a){return e.handleSwitch(t.row.id,t.row.status)}}})]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{plain:"",size:"small",type:"primary"},on:{click:function(a){return e.handleDialog("add",t.row)}}},[e._v("预览 ")]),a("el-button",{attrs:{plain:"",size:"small",type:"warning"},on:{click:function(a){return e.handleDialog("edit",t.row)}}},[e._v("编辑 ")])]}}])})],1),a("el-pagination",{staticClass:"m20",attrs:{background:"",layout:"prev, pager, next,total",total:e.page.total,"page-size":e.page.size,"current-page":e.page.index},on:{"current-change":e.pageCurrentChange,"update:currentPage":function(t){return e.$set(e.page,"index",t)},"update:current-page":function(t){return e.$set(e.page,"index",t)}}}),a("template-resource-dialog",{attrs:{"dialog-data":e.dialogData}})],1)},n=[],l=(a("b449"),a("ae9a")),r=a("a833"),o=a("bcaf"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"template-resource-dialog",attrs:{top:"5vh",width:"1200px",title:e.title,visible:e.dialogData.show,"close-on-click-modal":!1,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.dialogData,"show",t)}}},[a("div",[a("el-form",{attrs:{model:e.form,"label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:"名称："}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.template_data.title,callback:function(t){e.$set(e.form.template_data,"title",t)},expression:"form.template_data.title"}})],1),a("el-form-item",{attrs:{label:"状态："}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66"},model:{value:e.form.template_data.status,callback:function(t){e.$set(e.form.template_data,"status",t)},expression:"form.template_data.status"}})],1),a("el-form-item",{attrs:{label:"模板："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.template_data.layout,callback:function(t){e.$set(e.form.template_data,"layout",t)},expression:"form.template_data.layout"}},[a("el-option",{attrs:{label:"横向大卡片",value:1}})],1)],1),a("el-form-item",{attrs:{label:"过渡环节："}},[a("el-radio-group",{model:{value:e.form.template_data.is_excessive,callback:function(t){e.$set(e.form.template_data,"is_excessive",t)},expression:"form.template_data.is_excessive"}},[a("el-radio",{staticStyle:{"margin-right":"0"},attrs:{label:1,border:""}},[e._v("是")]),a("el-radio",{attrs:{label:0,border:""}},[e._v("否")])],1)],1),a("el-form-item",{attrs:{label:"关联环节："}},[a("div",{staticClass:"segment-card"},e._l(e.form.template_data_details,(function(t,i){return a("div",{staticClass:"card-item"},[a("div",{staticClass:"card-item-header"},[a("el-select",{attrs:{placeholder:"选择环节"},model:{value:t.segment_template_id,callback:function(a){e.$set(t,"segment_template_id",a)},expression:"segement.segment_template_id"}},e._l(e.listSegment,(function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1),a("el-button-group",[a("el-button",{attrs:{type:"default",icon:"el-icon-minus",disabled:e.form.template_data_details.length<2},on:{click:function(t){return e.segmentDel(i)}}}),a("el-button",{attrs:{type:"default",icon:"el-icon-plus"},on:{click:function(t){return e.segmentAdd(i)}}})],1)],1),a("el-card",{attrs:{shadow:"hover","body-style":{padding:"12px"}}},[a("div",{staticClass:"header"},[a("el-input",{attrs:{disabled:"",placeholder:"标题"},model:{value:t.title,callback:function(a){e.$set(t,"title",a)},expression:"segement.title"}})],1),a("el-divider"),a("el-upload",{staticClass:"upload-item",attrs:{action:"/api/public/upload",accept:"image/*",disabled:"","show-file-list":!1,"http-request":function(t){return e.uploadFile(t,i)},"list-type":"picture-card",multiple:""}},[t.cover?a("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{fit:"cover",src:t.cover}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1),a("el-divider"),a("el-select",{attrs:{placeholder:"关联引导",clearable:""},model:{value:t.lead_type,callback:function(a){e.$set(t,"lead_type",a)},expression:"segement.lead_type"}},e._l(e.dictoryObj.SegmentLeadTypeEnum,(function(e){return a("el-option",{key:e.key,attrs:{label:e.value,value:e.key}})})),1)],1)],1)})),0)])],1)],1),"view"!==e.dialogData.type?a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.dialogToggle}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.dialogSave}},[e._v("确 定")])],1):e._e()])},c=[],d=(a("ea69"),a("91b6")),u={template_data:{title:"",layout:1,status:1,is_excessive:1},template_data_details:[{segment_template_id:"",lead_type:"",title:"",cover:""}]},p={segment_template_id:"",lead_type:"",title:"",cover:""},m={name:"TemplateResourceDialog",mixins:[r["a"],o["a"]],props:{dialogData:{type:Object,default:{show:!1,type:"",param:{id:0}}}},data:function(){return{title:"",listSegment:[],SEGMENT_ITEM:p,form:JSON.parse(JSON.stringify(u))}},watch:{"dialogData.show":function(e){e&&this.init()}},methods:{init:function(){console.log(this.dictoryObj),this.getSegmentAll(),"add"==this.dialogData.type?(this.title="新增教材模板",this.form=JSON.parse(JSON.stringify(u))):"edit"==this.dialogData.type?(this.title="编辑教材模板",this.form={template_data:this.dialogData.param,template_data_details:this.dialogData.param.template_data_details.length?this.dialogData.param.template_data_details:u.template_data_details}):"view"==this.dialogData.type&&(this.title="查看教材模板",this.form=this.dialogData.param)},getSegmentAll:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiBasic.getSegment({scene:"all"});case 2:a=t.sent,e.listSegment=a.items;case 4:case"end":return t.stop()}}),t)})))()},segmentAdd:function(e){this.form.template_data_details.splice(e+1,0,JSON.parse(JSON.stringify(p)))},segmentDel:function(e){this.form.template_data_details.splice(e,1)},uploadFile:function(e,t){var a=this;return Object(l["a"])(regeneratorRuntime.mark((function i(){var n;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,Object(d["a"])(e.file);case 2:n=i.sent,a.form.template_data_details[t].cover=n.url;case 4:case"end":return i.stop()}}),i)})))()},openMedia:function(e){console.log("media url",e),window.open(e,"_blank")},dialogToggle:function(){this.dialogData.show=!this.dialogData.show},dialogSave:function(){var e,t=this,a={template_data:JSON.stringify(this.form.template_data),template_data_details:JSON.stringify(this.form.template_data_details)};console.log(a),this.dialogData.param.id?(a.id=this.dialogData.param.id,e=this.ApiBasic.putResource):e=this.ApiBasic.postResource,e(a).then((function(e){t.$message({type:"success",message:"保存成功"}),t.dialogToggle(),t.$parent.getData()}))}}},f=m,g=(a("d0d1"),a("4023")),h=Object(g["a"])(f,s,c,!1,null,null,null),v=h.exports,_={name:"TemplateResource",mixins:[r["a"],o["a"]],components:{TemplateResourceDialog:v},data:function(){return{loading:!0,dialogData:{show:!1},list:[],page:{total:0,index:1,size:10}}},mounted:function(){this.getData()},methods:{handleDialog:function(e,t){this.dialogData={show:!0,type:e,param:t||{id:0}}},handleSwitch:function(e,t){var a,i=this,n="";0===t?(a="enable",n="启用"):1===t&&(a="disable",n="停用"),this.$confirm("确定 ".concat(n," 模板？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.loading=!0;var t={id:e,status:a};i.ApiBasic.postResourceStatus(t).then((function(e){i.$message.success("修改成功"),i.getData(),i.loading=!1})).catch((function(e){console.log(e),i.loading=!1}))})).catch((function(){i.$message.info("已取消")}))},getData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={pageIndex:e.page.index,pageSize:e.page.size},t.next=3,e.ApiBasic.getResource(a);case 3:i=t.sent,e.loading=!1,e.list=i.items,e.page.total=i.total;case 7:case"end":return t.stop()}}),t)})))()},pageCurrentChange:function(e){this.page.index=e,this.getData()}}},b=_,y=Object(g["a"])(b,i,n,!1,null,"77b41374",null);t["default"]=y.exports},a833:function(e,t,a){"use strict";a("dbb3"),a("fe59"),a("513c"),a("20a5"),a("e35a"),a("5e9f"),a("08ba"),a("b449");var i=a("ae9a"),n=a("0eaa"),l=a("ae8c");t["a"]={inject:["ApiBasic","ApiResource","ApiBase","ApiProduction","ApiOther","ApiUser","ApiReport","cloneDeep","ApiMenu","dayjs","ApiOrder","ApiCourse"],computed:Object(n["a"])({},Object(l["c"])("course",{dictoryObj:"dictoryObj"})),data:function(){return{loading:!0,total:1,uid:"",userList:[],clickmodal:!1}},methods:{openLoading:function(){this.loading=!0},formatNum:function(e){return e=Number(e),(e.toFixed(2)+"").replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,")},closeLoading:function(){this.loading=!1},confirmDelMessage:function(e,t,a){this.$confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.t0=t,!e.t0){e.next=5;break}return e.next=4,t();case 4:e.t0=e.sent;case 5:i=e.t0,"number"!=typeof i&&a&&a();case 7:case"end":return e.stop()}}),e)}))))},tipMessage:function(e,t){this.$message({showClose:!0,message:e,type:t})},getTreeList:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0;if(Array.isArray(e))return e.forEach((function(l){if(l.parentId===a)return i.push(l),l.children=[],t.getTreeList(e,l[n],l.children,n)})),i},flatten:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.forEach((function(e){e.index=a,i.push(e),e.children&&t.flatten(e.children,a+1,i)})),i},filterAllChild:function(){},remoteMethod:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.ApiUser.getSelectUsers(e);case 2:t.userList=a.sent;case 3:case"end":return a.stop()}}),a)})))()},getTarget:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.filter((function(e){if(e.parentId===t)return e}))}}}},b117:function(e,t,a){},d0d1:function(e,t,a){"use strict";var i=a("b117"),n=a.n(i);n.a},ea69:function(e,t,a){"use strict";var i=a("1c8b"),n=a("e1d6"),l=a("3da3"),r=a("d88d"),o=a("3553"),s=a("1ca1"),c=a("1bbd"),d=a("1ea7"),u=a("ff9c"),p=d("splice"),m=u("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,g=Math.min,h=9007199254740991,v="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!p||!m},{splice:function(e,t){var a,i,d,u,p,m,_=o(this),b=r(_.length),y=n(e,b),w=arguments.length;if(0===w?a=i=0:1===w?(a=0,i=b-y):(a=w-2,i=g(f(l(t),0),b-y)),b+a-i>h)throw TypeError(v);for(d=s(_,i),u=0;u<i;u++)p=y+u,p in _&&c(d,u,_[p]);if(d.length=i,a<i){for(u=y;u<b-i;u++)p=u+i,m=u+a,p in _?_[m]=_[p]:delete _[m];for(u=b;u>b-i+a;u--)delete _[u-1]}else if(a>i)for(u=b-i;u>y;u--)p=u+i-1,m=u+a-1,p in _?_[m]=_[p]:delete _[m];for(u=0;u<a;u++)_[u+y]=arguments[u+2];return _.length=b-i+a,d}})}}]);