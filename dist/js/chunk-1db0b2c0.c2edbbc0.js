(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1db0b2c0"],{"43e5":function(e,t,n){"use strict";n("dbb3"),n("fe59"),n("08ba"),n("b449");var r=n("ae9a");t["a"]={data:function(){return{orgId:"",productId:"",uid:"",beginDate:"",endDate:"",orgs:[],products:[],userList:[],valueDate:[],inventoryList:[],type:"",allProCityList:[],provinceList:[],reportList:[]}},methods:{getOrgs:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiOther.getOrgs();case 2:n=t.sent,r=e.getTreeList(n,0,[],"orgId"),n=e.flattenOrgs(r),e.orgs=n;case 6:case"end":return t.stop()}}),t)})))()},getProduct:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiProduction.getProduct();case 2:e.products=t.sent;case 3:case"end":return t.stop()}}),t)})))()},flattenOrgs:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.forEach((function(e){e.index=r,n.push(e),e.children&&t.flattenOrgs(e.children,n,r+1)})),n},getUsers:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.ApiUser.getSelectUsers(e);case 2:t.userList=n.sent;case 3:case"end":return n.stop()}}),n)})))()},getInventorTypes:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiProduction.productPurchaseType();case 2:e.inventoryList=t.sent;case 3:case"end":return t.stop()}}),t)})))()},getAllProvince:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiOther.dictProvince();case 2:e.allProCityList=t.sent,e.provinceList=e.getTarget(e.allProCityList);case 4:case"end":return t.stop()}}),t)})))()},getTarget:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.filter((function(e){if(e.parentId===t)return e}))}}}},"98a4":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("el-row",{staticClass:"m20 el-form100",attrs:{gutter:20}},[n("el-col",{attrs:{span:4}},[n("el-select",{attrs:{placeholder:"请选择组织","value-key":"orgId",clearable:""},model:{value:e.orgId,callback:function(t){e.orgId=t},expression:"orgId"}},e._l(e.orgs,(function(t){return n("el-option",{key:t.orgId,attrs:{label:t.orgName,value:t.orgId}},[e._l(t.index,(function(t){return n("span",{staticClass:"opcaity"},[e._v("13")])})),n("span",[e._v(e._s(t.orgName))])],2)})),1)],1),n("el-col",{attrs:{span:4}},[n("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",placeholder:"请选择经销人员","remote-method":e.remoteMethod,"value-key":"id",clearable:""},model:{value:e.uid,callback:function(t){e.uid=t},expression:"uid"}},e._l(e.userList,(function(e){return n("el-option",{key:e.uid,attrs:{label:e.nickname,value:e.uid}})})),1)],1),n("el-col",{attrs:{span:4}},[n("el-select",{attrs:{placeholder:"请选择商品","value-key":"id",clearable:""},model:{value:e.productId,callback:function(t){e.productId=t},expression:"productId"}},e._l(e.products,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),n("el-col",{attrs:{span:6}},[n("div",{staticClass:"flexCenterH"},[n("div",[n("el-input",{attrs:{type:"number",placeholder:"库存数"},on:{change:e.changeNumber},model:{value:e.beginAmount,callback:function(t){e.beginAmount=t},expression:"beginAmount"}})],1),n("span",{staticStyle:{margin:"0 10px"}},[e._v("至")]),n("div",[n("el-input",{attrs:{type:"number",placeholder:"库存数"},on:{change:e.changeNumber},model:{value:e.endAmount,callback:function(t){e.endAmount=t},expression:"endAmount"}})],1)])]),n("el-col",{staticClass:"textLeft",attrs:{span:4}},[n("el-button",{attrs:{type:"primary"},on:{click:e.searchM}},[e._v("查询")])],1)],1),n("my-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.data}},[e._l(e.columnslist,(function(e){return n("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label}})})),n("el-table-column",{attrs:{prop:"priceV",label:"销售价"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("span",[e._v(e._s(e._f("formatNum")(r.priceV)))])]}}])}),n("el-table-column",{attrs:{label:"经销库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.firstWarningAmount<t.row.firstAmount?n("el-link",{attrs:{type:"primary"},on:{click:function(n){return e.showDetail(t,1)}}},[e._v(e._s(t.row.firstAmount)+" ")]):n("el-link",{attrs:{type:"danger"},on:{click:function(n){return e.showDetail(t,1)}}},[e._v(e._s(t.row.firstAmount)+" ")])]}}])}),n("el-table-column",{attrs:{label:"裂变库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.secondWarningAmount<t.row.secondAmount?n("el-link",{attrs:{type:"primary"},on:{click:function(n){return e.showDetail(t,0)}}},[e._v(e._s(t.row.secondAmount)+" ")]):n("el-link",{attrs:{type:"danger"},on:{click:function(n){return e.showDetail(t,1)}}},[e._v(e._s(t.row.secondAmount)+" ")])]}}])})],2),e.dialogFormVisible?n("el-dialog",{attrs:{title:"库存流水",visible:e.dialogFormVisible,"close-on-click-modal":e.clickmodal},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-row",{staticClass:"textLeft m20 el-form100",attrs:{gutter:20}},[n("el-col",{attrs:{span:10}},[n("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeDate},model:{value:e.valueDate,callback:function(t){e.valueDate=t},expression:"valueDate"}})],1),n("el-col",{attrs:{span:6}},[n("el-select",{attrs:{placeholder:"请选择类型","value-key":"id"},on:{change:e.changeType},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[n("el-option",{attrs:{value:""}},[e._v("请选择类型")]),e._l(e.stockTypes,(function(e){return n("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],2)],1),n("el-col",{staticClass:"textLeft",attrs:{span:4}},[n("el-button",{attrs:{type:"success"},on:{click:e.searchChildTable}},[e._v("查询")])],1)],1),n("my-table",{attrs:{data:e.data1}},e._l(e.c1,(function(e){return n("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label}})})),1),n("el-pagination",{staticClass:"m20",attrs:{background:"",layout:"prev, pager, next,total",total:e.total,"page-size":e.pageSize,"current-page":e.curPage},on:{"current-change":e.currentChange,"update:currentPage":function(t){e.curPage=t},"update:current-page":function(t){e.curPage=t}}})],1):e._e()],1)},a=[],o=(n("fe59"),n("053b"),n("08ba"),n("b449"),n("ae9a")),i=n("bcaf"),c=n("a833"),s=n("43e5"),u={name:"StockManager",mixins:[i["a"],c["a"],s["a"]],data:function(){return{orgId:"",data:[],productId:"",columnslist:[{prop:"orgName",label:"所属组织"},{prop:"nickname",label:"经销人员"},{prop:"identityV",label:"身份"},{prop:"productV",label:"商品名称"}],products:[],orgs:[],identityId:"",identitys:[],valueDate:[],typeList:[],rowId:"",type:"",data1:[],c1:[{prop:"typeV",label:"类型"},{prop:"amount",label:"库存变化"},{prop:"createTime",label:"时间"},{prop:"newAmount",label:"剩余库存"}],stockTypes:[],username:"",beginDate:"",endDate:"",name:"",beginAmount:"",endAmount:"",pageSize:5}},methods:{searchChildTable:function(){this.getPageStockLog()},changeType:function(e){this.curPage=1,this.o.curPage=1,this.o.type=this.type,this.searchChildTable()},changeDate:function(){this.curPage=1,this.o.curPage=1,this.valueDate&&this.valueDate.length?(this.beginDate=this.dayjs(this.valueDate[0]).format("YYYY-MM-DD"),this.endDate=this.dayjs(this.valueDate[1]).format("YYYY-MM-DD"),this.o.beginDate=this.beginDate,this.o.endDate=this.endDate):(this.o.beginDate=this.beginDate="",this.o.endDate=this.endDate="")},searchM:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.productStock();case 1:case"end":return t.stop()}}),t)})))()},getPageStockLog:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getProductStockLog(e.o);case 2:n=t.sent,e.total=n.rowCount,n.list.forEach((function(t){e.stockTypes.forEach((function(e){t.type===e.value&&(t.typeV=e.name)}))})),e.data1=n.list,e.open();case 7:case"end":return t.stop()}}),t)})))()},resetData:function(){this.curPage=1,this.valueDate=[],this.beginAmount="",this.endAmount="",this.type=""},showDetail:function(e,t){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.row,n.resetData(),n.o={curPage:n.curPage,pageSize:n.pageSize,uid:a.uid,productId:a.productId,type:n.type,isFirst:t,beginDate:n.beginDate,endDate:n.endDate},r.next=5,n.stockLogType();case 5:n.getPageStockLog();case 6:case"end":return r.stop()}}),r)})))()},currentChange:function(){this.o.curPage=this.curPage,this.getPageStockLog()},getProductStockLog:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.ApiProduction.productStockLog(e);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},getProduct:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiProduction.getProduct();case 2:e.products=t.sent;case 3:case"end":return t.stop()}}),t)})))()},stockLogType:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiProduction.stockLogType();case 2:e.stockTypes=t.sent;case 3:case"end":return t.stop()}}),t)})))()},getIndetitys:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiUser.getUserIdentitys();case 2:e.identitys=t.sent;case 3:case"end":return t.stop()}}),t)})))()},productPurchaseType:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.ApiProduction.productPurchaseType();case 2:e.typeList=t.sent;case 3:case"end":return t.stop()}}),t)})))()},changeNumber:function(){this.beginAmount=parseInt(this.beginAmount)||"",this.endAmount=parseInt(this.endAmount)||""},productStock:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.openLoading(),t.next=3,e.ApiProduction.productStock({productId:e.productId,orgId:e.orgId,curPage:e.curPage,uid:e.uid,pageSize:e.pageSize,beginAmount:e.beginAmount,endAmount:e.endAmount});case 3:n=t.sent,n.list.forEach((function(t){e.identitys.forEach((function(e){e.id===t.identityId&&(t.identityV=e.name)})),e.products.forEach((function(e){e.id===t.productId&&(t.productV=e.name,t.priceV=e.price)}))})),e.data=n.list,e.closeLoading();case 7:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.productPurchaseType();case 2:return t.next=4,e.getProduct();case 4:return t.next=6,e.getOrgs();case 6:return t.next=8,e.getIndetitys();case 8:return t.next=10,e.productStock();case 10:e.remoteMethod("");case 11:case"end":return t.stop()}}),t)})))()}},l=u,p=n("4023"),d=Object(p["a"])(l,r,a,!1,null,null,null);t["default"]=d.exports},a833:function(e,t,n){"use strict";n("dbb3"),n("fe59"),n("513c"),n("20a5"),n("e35a"),n("5e9f"),n("08ba"),n("b449");var r=n("ae9a"),a=n("0eaa"),o=n("ae8c");t["a"]={inject:["ApiBasic","ApiResource","ApiBase","ApiProduction","ApiOther","ApiUser","ApiReport","cloneDeep","ApiMenu","dayjs","ApiOrder","ApiCourse"],computed:Object(a["a"])({},Object(o["c"])("course",{dictoryObj:"dictoryObj"})),data:function(){return{loading:!0,total:1,uid:"",userList:[],clickmodal:!1}},methods:{openLoading:function(){this.loading=!0},formatNum:function(e){return e=Number(e),(e.toFixed(2)+"").replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,")},closeLoading:function(){this.loading=!1},confirmDelMessage:function(e,t,n){this.$confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.t0=t,!e.t0){e.next=5;break}return e.next=4,t();case 4:e.t0=e.sent;case 5:r=e.t0,"number"!=typeof r&&n&&n();case 7:case"end":return e.stop()}}),e)}))))},tipMessage:function(e,t){this.$message({showClose:!0,message:e,type:t})},getTreeList:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3?arguments[3]:void 0;if(Array.isArray(e))return e.forEach((function(o){if(o.parentId===n)return r.push(o),o.children=[],t.getTreeList(e,o[a],o.children,a)})),r},flatten:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.forEach((function(e){e.index=n,r.push(e),e.children&&t.flatten(e.children,n+1,r)})),r},filterAllChild:function(){},remoteMethod:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.ApiUser.getSelectUsers(e);case 2:t.userList=n.sent;case 3:case"end":return n.stop()}}),n)})))()},getTarget:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.filter((function(e){if(e.parentId===t)return e}))}}}}}]);